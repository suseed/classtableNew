<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>êµìœ¡ ê³¼ì • ê´€ë¦¬ íˆ´</title>
  <!-- Tailwind CDN for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#f5f7fa; }
    .alt-row { background:#eef2f7; }
    @media print {
      body * { visibility: hidden; }
      #course-table, #course-table * { visibility: visible; }
      #course-table { position: absolute; left: 0; top: 0; width:100%; }
    }
  </style>
</head>
<body class="p-6">
  <h1 class="text-2xl font-bold mb-4">êµìœ¡ ê³¼ì • ê´€ë¦¬</h1>
  <!-- â”€â”€â”€â”€â”€ ì…ë ¥ í¼ â”€â”€â”€â”€â”€ -->
  <form id="course-form" class="grid md:grid-cols-6 gap-4 bg-white p-4 rounded shadow mb-6">
    <div class="md:col-span-1">
      <label class="block text-sm font-medium">ë¶„ë¥˜</label>
      <input id="category" type="text" required class="w-full border p-1 rounded" placeholder="í™˜ê²½ë””ìì¸" />
    </div>

    <div class="md:col-span-2">
      <label class="block text-sm font-medium">ê³¼ì •ëª…</label>
      <input id="title" type="text" required class="w-full border p-1 rounded" placeholder="(ì œí’ˆë””ìì¸)3Dì œí’ˆë””ìì¸ê¸°ë°˜â€¦" />
    </div>

    <div class="md:col-span-2 flex gap-2">
      <div class="flex-1">
        <label class="block text-sm font-medium">ì‹œì‘ì¼</label>
        <input id="start-date" type="date" required class="w-full border p-1 rounded" />
      </div>
      <div class="flex-1">
        <label class="block text-sm font-medium">ì¢…ë£Œì¼</label>
        <input id="end-date" type="date" required class="w-full border p-1 rounded" />
      </div>
    </div>

    <div class="md:col-span-1 flex items-end">
      <button type="submit" class="w-full bg-sky-700 hover:bg-sky-800 text-white py-2 rounded">ì¶”ê°€</button>
    </div>
  </form>

  <!-- â”€â”€â”€â”€â”€ íˆ´ë°” â”€â”€â”€â”€â”€ -->
  <div class="flex flex-wrap gap-2 mb-4">
    <button id="export-json" class="bg-gray-700 hover:bg-gray-800 text-white px-3 py-1 rounded">JSON ë‚´ë³´ë‚´ê¸°</button>
    <input id="import-json-input" type="file" accept=".json" class="hidden" />
    <button id="import-json" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded">JSON ë¶ˆëŸ¬ì˜¤ê¸°</button>
    <button id="export-csv" class="bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1 rounded">CSV ë‚´ë³´ë‚´ê¸°</button>
    <button id="print-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1 rounded">Print</button>
    <button id="clear-btn" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded">ëª¨ë‘ ì§€ìš°ê¸°</button>
  </div>

  <!-- â”€â”€â”€â”€â”€ ë°ì´í„° í…Œì´ë¸” â”€â”€â”€â”€â”€ -->
  <div class="overflow-x-auto bg-white rounded shadow">
    <table id="course-table" class="min-w-full text-sm">
      <thead class="bg-sky-900 text-white">
        <tr>
          <th class="px-3 py-2 text-left">êµìœ¡ê³¼ì •ë¶„ë¥˜</th>
          <th class="px-3 py-2 text-left">ê³¼ì •ëª…</th>
          <th class="px-3 py-2 text-left">êµìœ¡ê¸°ê°„</th>
          <th class="px-3 py-2 text-center w-16">ì‚­ì œ</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

<script>
// â”€â”€â”€â”€â”€ í—¬í¼ â”€â”€â”€â”€â”€
const tbody          = document.getElementById('tbody');
const STORAGE_KEY    = 'courses';

const loadCourses = () => JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
const saveCourses = (data) => localStorage.setItem(STORAGE_KEY, JSON.stringify(data));

const formatDate = (v) => v ? v.replaceAll('-', '.') : '';

// â”€â”€â”€â”€â”€ í–‰ ì¶”ê°€ â”€â”€â”€â”€â”€
function addCourse(e){
  e.preventDefault();
  const cat  = document.getElementById('category').value.trim();
  const title= document.getElementById('title').value.trim();
  const sd   = document.getElementById('start-date').value;
  const ed   = document.getElementById('end-date').value;
  if(!cat||!title||!sd||!ed) return alert('ëª¨ë“  í•„ë“œë¥¼ ì±„ì›Œì£¼ì„¸ìš”');

  const course = {
    id: Date.now(),
    category: cat,
    title: title,
    startDate: sd,
    endDate: ed
  };
  const data = loadCourses();
  data.push(course);
  saveCourses(data);
  render();
  document.getElementById('course-form').reset();
}

// â”€â”€â”€â”€â”€ í–‰ ë Œë”ë§ â”€â”€â”€â”€â”€
function render(){
  tbody.innerHTML='';
  const data = loadCourses();
  data.forEach((c,idx)=>{
    const tr = document.createElement('tr');
    if(idx%2) tr.classList.add('alt-row');
    tr.innerHTML = `
      <td class="px-3 py-2 whitespace-nowrap">${c.category}</td>
      <td class="px-3 py-2">${c.title}</td>
      <td class="px-3 py-2">${formatDate(c.startDate)} ~ ${formatDate(c.endDate)}</td>
      <td class="px-3 py-2 text-center"><button onclick="removeCourse(${c.id})" class="text-red-600">ğŸ—‘ï¸</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function removeCourse(id){
  const data = loadCourses().filter(c=>c.id!==id);
  saveCourses(data);
  render();
}

// â”€â”€â”€â”€â”€ JSON I/O â”€â”€â”€â”€â”€
function exportJSON(){
  const blob = new Blob([JSON.stringify(loadCourses(),null,2)], {type:'application/json'});
  downloadBlob(blob, 'courses.json');
}

function importJSON(){ document.getElementById('import-json-input').click(); }

document.getElementById('import-json-input').addEventListener('change',e=>{
  const file=e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = ()=>{ try{ saveCourses(JSON.parse(reader.result)); render(); }catch(err){ alert('ì˜ëª»ëœ JSON íŒŒì¼ì…ë‹ˆë‹¤'); } };
  reader.readAsText(file);
});

// â”€â”€â”€â”€â”€ CSV â”€â”€â”€â”€â”€
function exportCSV(){
  const rows = [['êµìœ¡ê³¼ì •ë¶„ë¥˜','ê³¼ì •ëª…','ì‹œì‘ì¼','ì¢…ë£Œì¼']];
  loadCourses().forEach(c=> rows.push([c.category,c.title,formatDate(c.startDate),formatDate(c.endDate)]));
  const csv = rows.map(r=> r.map(v=> `"${v.replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
  downloadBlob(blob,'courses.csv');
}

// â”€â”€â”€â”€â”€ ê³µí†µ ë‹¤ìš´ë¡œë“œ â”€â”€â”€â”€â”€
function downloadBlob(blob,filename){
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url; a.download=filename; a.click();
  URL.revokeObjectURL(url);
}

// â”€â”€â”€â”€â”€ ì¸ì‡„ & í´ë¦¬ì–´ â”€â”€â”€â”€â”€
function printTable(){ window.print(); }
function clearAll(){ if(confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){ saveCourses([]); render(); } }

// â”€â”€â”€â”€â”€ ì´ë²¤íŠ¸ ë°”ì¸ë”© â”€â”€â”€â”€â”€
document.getElementById('course-form').addEventListener('submit',addCourse);
document.getElementById('export-json').addEventListener('click',exportJSON);
document.getElementById('import-json').addEventListener('click',importJSON);
document.getElementById('export-csv').addEventListener('click',exportCSV);
document.getElementById('print-btn').addEventListener('click',printTable);
document.getElementById('clear-btn').addEventListener('click',clearAll);

// â”€â”€â”€â”€â”€ ì´ˆê¸° ê·¸ë¦¬ê¸° â”€â”€â”€â”€â”€
render();
</script>
</body>
</html>
